!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=[{token:"undef",foreground:"FF0000"},{token:"comment",foreground:"008800"},{token:"sfunc",foreground:"FF909B"},{token:"func",foreground:"FF909B"},{token:"instr",foreground:"bf00ff",fontStyle:"bold"},{token:"macro",foreground:"7CFC00"},{token:"macroIndicator",foreground:"bf00ff"},{token:"inc",foreground:"7CFC00"},{token:"incPath",foreground:"87CEFA"},{token:"degree",foreground:"00FFFF"},{token:"pitOp-chord",foreground:"00BBFF"},{token:"durOp-stac-volOp",foreground:"00FFBB"},{token:"chordBracket",foreground:"00BBBB"},{token:"@bracket",foreground:"fc8f00"},{token:"volta",foreground:"FFFF00"},{token:"barline",foreground:"fc8f00"},{token:"repeat",foreground:"FFFF00"},{token:"press-release",foreground:"fcde00"},{token:"tie",foreground:"fcde00"}],r=t(1);window.onload=function(){window.require.config({paths:{vs:"vs"}}),window.require(["vs/editor/editor.main"],function(){window.monaco=monaco,monaco.languages.register({id:"smml",extensions:["sml"]}),monaco.editor.defineTheme("smml",{base:"vs-dark",inherit:!0,rules:o,colors:{}}),monaco.languages.setMonarchTokensProvider("smml",{tokenizer:{root:[{regex:/\/\/.*/,action:{token:"comment"}},{regex:/# *Track/,action:{token:"@rematch",next:"Macro"}},{regex:/# *Chord/,action:{token:"@rematch",next:"ChordDef"}},{regex:/# *Include/,action:{token:"@rematch",next:"@Inc"}},{regex:/\[(\d+\.)+\]/,action:{token:"volta"}},{regex:/<[^*]+>/,action:{token:"instr"}},{include:"Common"}],Subtrack:[{regex:/\d+\*|\/\d*:/,action:{token:"repeat"}},{regex:/\//,action:{token:"repeat"}},{regex:/\^\)|\)/,action:{token:"@rematch",next:"@pop"}},{include:"Common"}],Common:[{regex:/@[a-z]+/,action:{token:"macroIndicator"}},{regex:/(\$?)([\d%x])/,action:[{token:"func"},{cases:{"@eos":{token:"degree"},"@default":{token:"degree",next:"NoteOp"}}}]},{regex:/(\$?)(\[)/,action:[{token:"func"},{token:"@rematch",next:"Chord"}]},{regex:/\(/,action:{token:"@rematch",next:"Sfunc"}},{regex:/([A-Z][a-z]+)+\(/,action:{token:"@rematch",next:"Func"}},{regex:/{/,action:{bracket:"@open",token:"@bracket",next:"Subtrack"}},{regex:/}/,action:{bracket:"@close",token:"@bracket",next:"@pop"}},{regex:/&/,action:{token:"press-release"}},{regex:/\*/,action:{token:"press-release"}},{regex:/~/,action:{token:"func"}},{regex:/\^/,action:{token:"tie"}},{regex:/:\|\|:|:\|\||\|\|:|\|\||\|/,action:{token:"barline"}}],Sfunc:[{regex:/\(\.\)/,action:{token:"func",next:"@pop"}},{regex:/\(\^/,action:{token:"func",next:"Subtrack"}},{regex:/\(|\^|:|1=/,action:{token:"func"}},{regex:/{/,action:{token:"@bracket",next:"Subtrack"}},{regex:/[^\)]+\^\)/,action:{token:"@rematch",next:"Subtrack"}},{regex:/\^\)/,action:{token:"func",next:"@pop"}},{regex:/\)/,action:{token:"func",next:"@pop"}},{regex:/[A-Za-zb#%\d\.\-\/]/,action:{token:"number"}}],Func:[{regex:/[A-Z][a-z]+/,action:{token:"func"}},{regex:/\(/,action:{token:"func",next:"Arg"}},{regex:/\)/,action:{token:"func",next:"@pop"}},{regex:/,\s*/,action:{token:"func",next:"Arg"}}],Array:[{regex:/\[/,action:{token:"func",bracket:"@open",next:"Arg"}},{regex:/,\s*/,action:{token:"func",next:"Arg"}},{regex:/\]/,action:{token:"func",bracket:"@close",next:"@pop"}}],Arg:[{regex:/{/,action:{token:"@bracket",next:"Subtrack"}},{regex:/"[^"]*"/,action:{token:"string"}},{regex:/\[/,action:{token:"@rematch",next:"Array"}},{regex:/,|\)|\]/,action:{token:"@rematch",next:"@pop"}},{regex:/[^,\)}\[\]"]+/,action:{token:"number"}}],NoteOp:[{regex:/[^',b#a-zA-Z\-_\.=`:>]/,action:{token:"@rematch",next:"@pop"}},{include:"NoteAddon"}],NoteAddon:[{regex:/[',b#a-zA-Z]/,action:{cases:{"@eos":{token:"pitOp-chord",next:"@pop"},"@default":{token:"pitOp-chord"}}}},{regex:/[\-_\.=`:>]/,action:{cases:{"@eos":{token:"durOp-stac-volOp",next:"@pop"},"@default":{token:"durOp-stac-volOp"}}}}],Chord:[{regex:/\[/,action:{token:"@rematch",next:"ChordInside"}},{regex:/[^',b#a-zA-Z\-_\.=`:>]/,action:{token:"@rematch",next:"@pop"}},{include:"NoteAddon"}],ChordInside:[{regex:/\[/,action:{token:"chordBracket"}},{regex:/[\d%]/,action:{token:"degree"}},{regex:/[',b#a-zA-Z]/,action:{token:"pitOp-chord"}},{regex:/\]/,action:{token:"chordBracket",next:"@pop"}}],ChordDef:[{regex:/# *Chord/,action:{token:"macro",bracket:"@open"}},{regex:/# *End/,action:{token:"macro",bracket:"@close",next:"@pop"}},{regex:/^.+$/,action:{token:"@rematch",next:"ChordDefLine"}}],ChordDefLine:[{regex:/^[a-zA-Z]/,action:{token:"pitOp-chord"}},{regex:/\t+[^\t]+\t+/,action:{token:"comment"}},{regex:/.*/,action:{token:"pitOp-chord",next:"@pop"}}],Macro:[{regex:/# *Track/,action:{token:"macro",bracket:"@open"}},{regex:/<\*[A-Za-z\d]+\*>/,action:{token:"macroIndicator"}},{regex:/# *End/,action:{token:"macro",bracket:"@close",next:"@pop"}},{include:"Common"}],Inc:[{regex:/# *Include/,action:{token:"inc"}},{regex:/".*"/,action:{token:"incPath",next:"@pop"}}],Section:[],Track:[]},tokenPostfix:".sml",defaultToken:"undef"}),monaco.languages.registerDefinitionProvider("smml",{provideDefinition(e,n,t){const o=e.findMatches("@[a-z]+",!1,!0,!1,"",!0).find(e=>e.range.startLineNumber===n.lineNumber&&e.range.endLineNumber===n.lineNumber&&e.range.startColumn<=n.column&&e.range.endColumn>=n.column);if(!o)return;const r=e.findMatches(`<*${o.matches[0].slice(1)}*>`,!1,!1,!0,"",!1)[0];return{uri:e.uri,range:r.range}}}),monaco.languages.registerCompletionItemProvider("smml",{triggerCharacters:["<"],provideCompletionItems:(e,n,t)=>"<"===e.getValueInRange({startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:n.column-1,endColumn:n.column})?[{label:"Piano",kind:monaco.languages.CompletionItemKind.Variable,documentation:"Piano",insertText:"Piano>"}]:[]}),function(){const e=monaco.editor.create(document.getElementById("container"),{value:localStorage.getItem("lastText"),language:"smml",theme:"smml",folding:!0});e.addAction({id:"smml-save",label:"Save smml file",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){const n=e.getValue();localStorage.setItem("lastText",n);const t=n.slice(0,n.indexOf("\n"));let o;o=""!==t&&t.startsWith("//")?t.slice(2).trim():"new_file";const a=new Blob([n],{type:"text/plain;charset=utf-8"});r.saveAs(a,`${o}.sml`)}}),window.onresize=(()=>{e.layout()}),window.onbeforeunload=(n=>{const t=e.getValue();""!==t&&localStorage.setItem("lastText",t)})}()})}},function(e,n,t){var o,r=r||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var n=function(){return e.URL||e.webkitURL||e},t=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in t,r=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),c=function(n){(e.setImmediate||e.setTimeout)(function(){throw n},0)},i=function(e){setTimeout(function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()},4e4)},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(d,s,l){l||(d=u(d));var f,g=this,m="application/octet-stream"===d.type,k=function(){!function(e,n,t){for(var o=(n=[].concat(n)).length;o--;){var r=e["on"+n[o]];if("function"==typeof r)try{r.call(e,t||e)}catch(e){c(e)}}}(g,"writestart progress write writeend".split(" "))};if(g.readyState=g.INIT,o)return f=n().createObjectURL(d),void setTimeout(function(){t.href=f,t.download=s,function(e){var n=new MouseEvent("click");e.dispatchEvent(n)}(t),k(),i(f),g.readyState=g.DONE});!function(){if((a||m&&r)&&e.FileReader){var t=new FileReader;return t.onloadend=function(){var n=a?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(n,"_blank")||(e.location.href=n),n=void 0,g.readyState=g.DONE,k()},t.readAsDataURL(d),void(g.readyState=g.INIT)}f||(f=n().createObjectURL(d)),m?e.location.href=f:e.open(f,"_blank")||(e.location.href=f);g.readyState=g.DONE,k(),i(f)}()},s=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,n,t){return n=n||e.name||"download",t||(e=u(e)),navigator.msSaveOrOpenBlob(e,n)}:(s.abort=function(){},s.readyState=s.INIT=0,s.WRITING=1,s.DONE=2,s.error=s.onwritestart=s.onprogress=s.onwrite=s.onabort=s.onerror=s.onwriteend=null,function(e,n,t){return new d(e,n||e.name||"download",t)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=r:null!==t(2)&&null!==t(3)&&(void 0===(o=function(){return r}.call(n,t,n,e))||(e.exports=o))},function(e,n){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,n){(function(n){e.exports=n}).call(n,{})}]);